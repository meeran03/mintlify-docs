---
title: 'Update Structure'
api: 'PUT /api/v1/assistant-graphs/{graph_id}/structure'
description: 'Update the nodes and edges of an assistant graph'
---

Update the complete structure (nodes and edges) of an assistant graph. This endpoint replaces all existing nodes and edges with the provided data, making it ideal for use with visual graph builders.

<Warning>
This endpoint **replaces** all existing nodes and edges. Any nodes or edges not included in the request will be deleted. Active conversation sessions for this graph will also be cleared.
</Warning>

## Path Parameters

<ParamField path="graph_id" type="integer" required>
  The unique identifier of the graph to update.
</ParamField>

## Request Body

<ParamField body="nodes" type="array" required>
  Array of nodes to create. Replaces all existing nodes.

  <Expandable title="Node properties">
    <ParamField body="assistant_id" type="integer" required>
      ID of the assistant for this node.
    </ParamField>

    <ParamField body="node_type" type="string" default="assistant">
      Type of node: `entry`, `standard`, `exit`, `escalation`
    </ParamField>

    <ParamField body="position" type="object">
      Position in the visual graph builder.
      <Expandable title="Position properties">
        <ParamField body="x" type="number">X coordinate</ParamField>
        <ParamField body="y" type="number">Y coordinate</ParamField>
      </Expandable>
    </ParamField>

    <ParamField body="configuration" type="object">
      Node-specific configuration.
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="edges" type="array" required>
  Array of edges to create. Replaces all existing edges.

  <Expandable title="Edge properties">
    <ParamField body="from_node_id" type="integer" required>
      Index of the source node in the nodes array (0-based).
    </ParamField>

    <ParamField body="to_node_id" type="integer" required>
      Index of the target node in the nodes array (0-based).
    </ParamField>

    <ParamField body="condition_type" type="string" default="natural_language">
      Type of condition: `intent`, `natural_language`, `mathematical`, `state_variable`
    </ParamField>

    <ParamField body="intent_pattern" type="string">
      Comma-separated intent keywords.
    </ParamField>

    <ParamField body="natural_language_trigger" type="string">
      Natural language condition description.
    </ParamField>

    <ParamField body="mathematical_expression" type="string">
      Mathematical expression.
    </ParamField>

    <ParamField body="state_variable_condition" type="object">
      State variable condition configuration.
    </ParamField>

    <ParamField body="condition_logic" type="string" default="AND">
      Logic for combining conditions: `AND` or `OR`
    </ParamField>

    <ParamField body="priority" type="integer" default="0">
      Priority for evaluation (lower = higher priority).
    </ParamField>

    <ParamField body="handoff_sentence" type="string">
      Message spoken during transition.
    </ParamField>

    <ParamField body="description" type="string">
      Human-readable description.
    </ParamField>
  </Expandable>
</ParamField>

## Response

Returns the updated graph with all new nodes and edges.

<RequestExample>
```bash cURL
curl -X PUT https://api.burki.dev/api/v1/assistant-graphs/1/structure \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "nodes": [
      {
        "assistant_id": 1,
        "node_type": "entry",
        "position": {"x": 0, "y": 0}
      },
      {
        "assistant_id": 2,
        "node_type": "standard",
        "position": {"x": 250, "y": -150}
      },
      {
        "assistant_id": 3,
        "node_type": "standard",
        "position": {"x": 250, "y": 150}
      },
      {
        "assistant_id": 4,
        "node_type": "escalation",
        "position": {"x": 500, "y": 0}
      }
    ],
    "edges": [
      {
        "from_node_id": 0,
        "to_node_id": 1,
        "condition_type": "intent",
        "intent_pattern": "sales,purchase,buy,pricing",
        "priority": 1,
        "handoff_sentence": "Connecting you with our sales team."
      },
      {
        "from_node_id": 0,
        "to_node_id": 2,
        "condition_type": "intent",
        "intent_pattern": "support,help,issue,problem",
        "priority": 1,
        "handoff_sentence": "Let me transfer you to support."
      },
      {
        "from_node_id": 1,
        "to_node_id": 3,
        "condition_type": "natural_language",
        "natural_language_trigger": "Customer requests to speak with a human or manager",
        "priority": 1,
        "handoff_sentence": "I will connect you with a human agent."
      },
      {
        "from_node_id": 2,
        "to_node_id": 3,
        "condition_type": "mathematical",
        "mathematical_expression": "call_duration > 600",
        "priority": 2,
        "handoff_sentence": "Let me get a specialist to help you."
      }
    ]
  }'
```

```python Python
import requests

response = requests.put(
    "https://api.burki.dev/api/v1/assistant-graphs/1/structure",
    headers={"Authorization": "Bearer YOUR_API_KEY"},
    json={
        "nodes": [
            {"assistant_id": 1, "node_type": "entry", "position": {"x": 0, "y": 0}},
            {"assistant_id": 2, "node_type": "standard", "position": {"x": 250, "y": -150}},
            {"assistant_id": 3, "node_type": "standard", "position": {"x": 250, "y": 150}},
            {"assistant_id": 4, "node_type": "escalation", "position": {"x": 500, "y": 0}}
        ],
        "edges": [
            {
                "from_node_id": 0,
                "to_node_id": 1,
                "condition_type": "intent",
                "intent_pattern": "sales,purchase,buy",
                "priority": 1,
                "handoff_sentence": "Connecting you with sales."
            },
            {
                "from_node_id": 0,
                "to_node_id": 2,
                "condition_type": "intent",
                "intent_pattern": "support,help,issue",
                "priority": 1,
                "handoff_sentence": "Transferring to support."
            }
        ]
    }
)

graph = response.json()
print(f"Updated structure: {graph['total_nodes']} nodes, {graph['total_edges']} edges")
```

```javascript JavaScript
const response = await fetch('https://api.burki.dev/api/v1/assistant-graphs/1/structure', {
  method: 'PUT',
  headers: {
    'Authorization': 'Bearer YOUR_API_KEY',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    nodes: [
      { assistant_id: 1, node_type: 'entry', position: { x: 0, y: 0 } },
      { assistant_id: 2, node_type: 'standard', position: { x: 250, y: -150 } },
      { assistant_id: 3, node_type: 'standard', position: { x: 250, y: 150 } }
    ],
    edges: [
      {
        from_node_id: 0,
        to_node_id: 1,
        condition_type: 'intent',
        intent_pattern: 'sales,purchase,buy',
        priority: 1,
        handoff_sentence: 'Connecting you with sales.'
      }
    ]
  })
});

const graph = await response.json();
console.log(`Updated structure: ${graph.total_nodes} nodes, ${graph.total_edges} edges`);
```
</RequestExample>

<ResponseExample>
```json Response
{
  "id": 1,
  "organization_id": 1,
  "name": "Customer Service Router",
  "description": "Routes customers to the appropriate department",
  "is_active": true,
  "configuration": {},
  "nodes": [
    {
      "id": 201,
      "graph_id": 1,
      "assistant_id": 1,
      "node_type": "entry",
      "position": {"x": 0, "y": 0},
      "configuration": {},
      "created_at": "2025-01-19T16:00:00Z",
      "assistant_name": "Receptionist",
      "assistant_description": "Greets callers"
    },
    {
      "id": 202,
      "graph_id": 1,
      "assistant_id": 2,
      "node_type": "standard",
      "position": {"x": 250, "y": -150},
      "configuration": {},
      "created_at": "2025-01-19T16:00:00Z",
      "assistant_name": "Sales Specialist",
      "assistant_description": "Handles sales"
    },
    {
      "id": 203,
      "graph_id": 1,
      "assistant_id": 3,
      "node_type": "standard",
      "position": {"x": 250, "y": 150},
      "configuration": {},
      "created_at": "2025-01-19T16:00:00Z",
      "assistant_name": "Support Agent",
      "assistant_description": "Handles support"
    },
    {
      "id": 204,
      "graph_id": 1,
      "assistant_id": 4,
      "node_type": "escalation",
      "position": {"x": 500, "y": 0},
      "configuration": {},
      "created_at": "2025-01-19T16:00:00Z",
      "assistant_name": "Human Agent Router",
      "assistant_description": "Routes to human agents"
    }
  ],
  "edges": [
    {
      "id": 301,
      "graph_id": 1,
      "from_node_id": 201,
      "to_node_id": 202,
      "condition_type": "intent",
      "intent_pattern": "sales,purchase,buy,pricing",
      "condition_logic": "AND",
      "priority": 1,
      "is_active": true,
      "handoff_sentence": "Connecting you with our sales team.",
      "created_at": "2025-01-19T16:00:00Z",
      "updated_at": "2025-01-19T16:00:00Z"
    },
    {
      "id": 302,
      "graph_id": 1,
      "from_node_id": 201,
      "to_node_id": 203,
      "condition_type": "intent",
      "intent_pattern": "support,help,issue,problem",
      "condition_logic": "AND",
      "priority": 1,
      "is_active": true,
      "handoff_sentence": "Let me transfer you to support.",
      "created_at": "2025-01-19T16:00:00Z",
      "updated_at": "2025-01-19T16:00:00Z"
    }
  ],
  "total_nodes": 4,
  "total_edges": 2,
  "created_at": "2025-01-19T10:00:00Z",
  "updated_at": "2025-01-19T16:00:00Z"
}
```
</ResponseExample>

## Error Responses

| Status Code | Description |
|-------------|-------------|
| 400 | Invalid request - nodes or edges array missing |
| 401 | Unauthorized - Invalid or missing API key |
| 404 | Graph not found in your organization |
| 500 | Server error updating structure |

## Important Notes

<Note>
**Node ID References in Edges:**
When creating edges, `from_node_id` and `to_node_id` refer to the **index** of the node in the `nodes` array (0-based), not database IDs. The actual database IDs are assigned after creation.
</Note>

<Warning>
**Session Cleanup:**
Updating the graph structure invalidates existing conversation sessions. All active sessions for this graph will be cleared to prevent routing errors with outdated node references.
</Warning>

<Tip>
**Visual Graph Builder:**
This endpoint is designed to work seamlessly with visual graph builders. Simply serialize your canvas state (nodes with positions and edges with connections) and send it to this endpoint.
</Tip>
